---
title: Medusa Configuration
description: A comprehensive guide to configuring a Medusa application
---

import { Tabs, TabItem } from "@medusajs/docs"
import CodeBlock from "@theme/CodeBlock"

# Medusa Configuration Guide

The Medusa configuration file (`medusa-config.js`) is the central place to define your application's settings, modules, and plugins. This guide explains the structure and options available in the configuration file.

## Configuration Overview

<CodeBlock className="language-javascript" title="medusa-config.js">
{`import { loadEnv, defineConfig, Modules } from "@medusajs/framework/utils";

loadEnv(process.env.NODE_ENV!, process.cwd());

module.exports = defineConfig({
  admin: {
    disable: process.env.DISABLE_MEDUSA_ADMIN === "true",
    backendUrl: process.env.MEDUSA_BACKEND_URL,
  },
  projectConfig: {
    databaseUrl: process.env.DATABASE_URL,
    workerMode: process.env.MEDUSA_WORKER_MODE as "shared" | "worker" | "server",
    redisUrl: process.env.REDIS_URL,
    http: {
      storeCors: process.env.STORE_CORS!,
      adminCors: process.env.ADMIN_CORS!,
      authCors: process.env.AUTH_CORS!,
      jwtSecret: process.env.JWT_SECRET || "supersecret",
      cookieSecret: process.env.COOKIE_SECRET || "supersecret",
    },
  },
  plugins: [
    // Plugins configuration
  ],
  modules: [
    // Modules configuration
  ],
});`}
</CodeBlock>

The configuration file starts by importing necessary utilities and loading environment variables using the `loadEnv` function, which makes all variables from your `.env` file available in `process.env`.

## Base Configuration

### Admin Settings

The `admin` section configures the Medusa Admin dashboard:

```javascript
admin: {
  disable: process.env.DISABLE_MEDUSA_ADMIN === "true",
  backendUrl: process.env.MEDUSA_BACKEND_URL,
}
```

- `disable`: When set to `true`, disables the Medusa Admin dashboard
- `backendUrl`: The URL of your Medusa backend, used by the Admin dashboard to connect to your API

### Project Configuration

The `projectConfig` section defines core settings for your Medusa application:

```javascript
projectConfig: {
  databaseUrl: process.env.DATABASE_URL,
  workerMode: process.env.MEDUSA_WORKER_MODE as "shared" | "worker" | "server",
  redisUrl: process.env.REDIS_URL,
  http: {
    storeCors: process.env.STORE_CORS!,
    adminCors: process.env.ADMIN_CORS!,
    authCors: process.env.AUTH_CORS!,
    jwtSecret: process.env.JWT_SECRET || "supersecret",
    cookieSecret: process.env.COOKIE_SECRET || "supersecret",
  },
}
```

- `databaseUrl`: Connection string for your PostgreSQL database
- `workerMode`: Determines how background jobs are processed
  - `shared`: Both API and workers run in the same process
  - `worker`: Process runs as a worker only
  - `server`: Process runs as a server only
- `redisUrl`: Connection string for Redis, used for caching and events
- `http`: HTTP server configuration
  - `storeCors`: CORS settings for storefront API requests
  - `adminCors`: CORS settings for admin API requests
  - `authCors`: CORS settings for authentication endpoints
  - `jwtSecret`: Secret used to sign JWT tokens
  - `cookieSecret`: Secret used to sign cookies

## Plugins

Plugins extend Medusa's functionality with additional features. In this example, a Meilisearch plugin is configured for product search:

```javascript
plugins: [
  {
    resolve: '@rokmohar/medusa-plugin-meilisearch',
    options: {
      config: {
        host: '',
        apiKey: '',
      },
      settings: {
        products: {
          indexSettings: {
            searchableAttributes: ['title', 'description', 'variant_sku'],
            displayedAttributes: ['id', 'title', 'description', 'variant_sku', 'thumbnail', 'handle'],
          },
          primaryKey: 'id',
          // Custom transformer function can be uncommented and modified as needed
        },
      },
    },
  },
]
```

Each plugin has:
- `resolve`: The plugin package name or path
- `options`: Configuration options specific to the plugin

## Modules

Modules are modular components that provide core functionality in Medusa. Your configuration includes several modules:

### Payment Module

```javascript
{
  resolve: "@medusajs/medusa/payment",
  options: {
    providers: [
      {
        resolve: "@medusajs/medusa/payment-stripe",
        id: "stripe",
        options: {
          apiKey: process.env.STRIPE_API_KEY,
        },
      },
    ],
  },
}
```

This configures Stripe as a payment provider with your API key.

### File Storage Module

```javascript
{
  resolve: '@medusajs/medusa/file',
  options: {
    providers: [
      {
        resolve: '@medusajs/medusa/file-s3',
        id: 's3',
        options: {
          file_url: process.env.S3_FILE_URL,
          access_key_id: process.env.S3_ACCESS_KEY_ID,
          secret_access_key: process.env.S3_SECRET_ACCESS_KEY,
          region: process.env.S3_REGION,
          bucket: process.env.S3_BUCKET,
          endpoint: process.env.S3_ENDPOINT,
          additional_client_config: {
            forcePathStyle: true,
          },
        },
      },
    ],
  },
}
```

This configures AWS S3 (or compatible service) for file storage with your credentials.

### Redis-based Infrastructure

Three modules configure Redis for different purposes:

```javascript
{
  resolve: '@medusajs/medusa/cache-redis',
  options: {
    redisUrl: process.env.REDIS_URL,
  },
}
```
Configures Redis for caching data to improve performance.

```javascript
{
  resolve: '@medusajs/medusa/event-bus-redis',
  options: {
    redisUrl: process.env.REDIS_URL,
  },
}
```
Sets up Redis for the event system to handle asynchronous events.

```javascript
{
  resolve: '@medusajs/medusa/workflow-engine-redis',
  options: {
    redis: {
      url: process.env.REDIS_URL,
    },
  },
}
```
Configures Redis for the workflow engine to manage complex business processes.

### Custom Modules

```javascript
{
  resolve: './src/modules/variant-images-settings',
}
```
Includes a custom module for variant images settings from your local source code.

### Notification Module

```javascript
{
  resolve: "@medusajs/medusa/notification",
  options: {
    providers: [
      {
        resolve: "./src/modules/resend",
        id: "resend",
        options: {
          channels: ["email"],
          api_key: process.env.RESEND_API_KEY,
          from: process.env.RESEND_FROM_EMAIL,
        },
      },
    ],
  },
}
```
Configures the notification system with a custom Resend email provider.

## Environment Variables

Your configuration uses several environment variables that should be defined in your `.env` file:

### Core Settings
- `NODE_ENV`: The environment mode (development, production, test)
- `DATABASE_URL`: PostgreSQL connection string
- `REDIS_URL`: Redis connection string
- `MEDUSA_WORKER_MODE`: Worker mode configuration

### Admin Settings
- `DISABLE_MEDUSA_ADMIN`: Whether to disable the admin dashboard
- `MEDUSA_BACKEND_URL`: URL for the Medusa backend

### CORS Settings
- `STORE_CORS`: CORS settings for the storefront
- `ADMIN_CORS`: CORS settings for the admin
- `AUTH_CORS`: CORS settings for authentication

### Security
- `JWT_SECRET`: Secret for signing JWT tokens
- `COOKIE_SECRET`: Secret for signing cookies

### Services
- `STRIPE_API_KEY`: API key for Stripe
- `RESEND_API_KEY`: API key for Resend
- `RESEND_FROM_EMAIL`: Email address to send from

### S3 Storage
- `S3_FILE_URL`: Base URL for accessing files
- `S3_ACCESS_KEY_ID`: AWS access key ID
- `S3_SECRET_ACCESS_KEY`: AWS secret access key
- `S3_REGION`: AWS region
- `S3_BUCKET`: S3 bucket name
- `S3_ENDPOINT`: S3 endpoint URL (for custom endpoints)

## Example .env File

```
# Environment
NODE_ENV=development

# Database
DATABASE_URL=postgres://username:password@localhost:5432/medusa-db

# Redis
REDIS_URL=redis://localhost:6379

# Worker Mode
MEDUSA_WORKER_MODE=shared

# Admin
DISABLE_MEDUSA_ADMIN=false
MEDUSA_BACKEND_URL=http://localhost:9000

# CORS
STORE_CORS=http://localhost:8000,http://localhost:3000
ADMIN_CORS=http://localhost:7000,http://localhost:7001
AUTH_CORS=http://localhost:8000,http://localhost:7000

# Security
JWT_SECRET=your_jwt_secret_here
COOKIE_SECRET=your_cookie_secret_here

# Stripe
STRIPE_API_KEY=sk_test_...

# Resend
RESEND_API_KEY=re_...
RESEND_FROM_EMAIL=noreply@yourdomain.com

# S3
S3_FILE_URL=https://your-bucket.s3.region.amazonaws.com
S3_ACCESS_KEY_ID=your_access_key
S3_SECRET_ACCESS_KEY=your_secret_key
S3_REGION=eu-west-1
S3_BUCKET=your-bucket-name
S3_ENDPOINT=https://s3.region.amazonaws.com
```

## Best Practices

1. **Environment Variables**: Store sensitive information like API keys in environment variables rather than hardcoding them in your configuration
2. **Secrets**: Use strong, unique secrets for JWT and cookies in production
3. **CORS Settings**: Configure CORS settings carefully to allow only necessary domains
4. **Module Organization**: Organize modules logically by their function
5. **Development vs Production**: Consider using different configurations for development and production environments

## Resources

- [Medusa Configuration Documentation](https://docs.medusajs.com/advanced/backend/configuration)
- [Environment Variables Guide](https://docs.medusajs.com/development/backend/configurations/environment-variables)
- [CORS Configuration](https://docs.medusajs.com/development/backend/configurations/cors)
- [Modules Documentation](https://docs.medusajs.com/learn/fundamentals/modules)
